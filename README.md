The code uses ESP32 with UART2 (pins 17 tx and 16Rx). It is able to control the speed the microsteps. 
If setup done correctly, the serial output should be able to display the correct microstep settings. 
The direction change does not want to work however. I honestly don't know why. I used different codes and techniques to no avail.
Please set it up and run it from your end, so we can rule out some of the possible reasons as to why it is not working.
